<!DOCTYPE html>
<html lang="en">
<head>
	<title>AUDIO IIAP V1.1</title>
	<meta charset="utf-8"/>
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1"/>  

	<meta name="description" content="BIOSONIC IIAP V1.1 ES SOLO PARA EL IIAP &amp; ESPECTROGRAMA FRECUENCIAS Y AUDIO"/>
	<meta property="og:image" content="https://www.gob.pe/iia"/>
	<meta property="og:title" content="BIOSONIC V1.1">
	<meta property="og:url" content="https://www.gob.pe/iia">
	<meta property="og:description" content="BIOSONIC-IIAP V1.1 es un software hecho para el IIAP iquitos &amp; Herramienta de edicion y Espectrograma">
	<meta name="keywords" content="BIOSONIC-IIAP V1., herramienta de audio, editor de forma de Espectrograma DESARROLLADO POR CRISTIAN RODRIGUEZ">
	<link href="/ico.ico" rel="shortcut icon">

<style>
	body{
		padding:0;margin:0;
		font-family: "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif;
		color:rgb(5, 10, 5);
		background:#fefefe
	}
	#w{
		width: 90%;
		max-width:960px;
		margin:0 auto
	}

	#w > div{
		padding:20px 0 0 0
	}

	p{
		line-height:21px;
		font-size:16px;
		margin-bottom:1.2em
	}

	h1{
		font-size: 26px;
		margin-top:35px
	}

	h5{
		font-size:1em;
		margin-bottom:0
	}

	.top{
		max-width:100%;
		outline:0;
		display:inline-block
	}

	.mid{
		max-width:504px;
		width: 90%;
		outline:0;
		margin-bottom:16px;
		display:inline-block
	}

	.nomarg{
		margin-bottom:0
	}

	pre {
	    padding:12px 16px;
	    display:inline-block;
	    border-radius:6px;
	    background:#e1f3e9;
	    text-shadow:0 1px #fff;
	    border-bottom:1px solid #aaa;
	    max-width:90%;
	    overflow:scroll
	}

	ul {
		padding:0;
		list-style:none
	}

	li {
		padding:0 0 3px 0;
		color:#333;
		font-size:0.92em
	}

	video {
		max-width:660px;
		width:90%;
	}

	::-moz-selection { background: #080808; color:#fff; text-shadow:none }
	::selection { background: #080808;  color:#fff; text-shadow:none }
</style>
</head>
<body>
<div id="w">


<div>
<h1>INTRODUCCION A BIOSONIC V1.1S (<a href="https://www.gob.pe/iia" target="_blank">https://www.gob.pe/iiap</a>) Una herramienta de edición de audio y forma de onda con Espectrograma</h1>


<img class="top" src="/about/audiomass_top.jpg" />


<p>AUDIO IIAP V1.1 te permite grabar, o usar tus pistas de audio existentes, y modificarlas recortando, cortando, pegando o aplicando una gran cantidad de efectos, desde ecualizadores de compresión y paragráficos hasta efectos de reverberación, retardo y distorsión. AudioMass también admite más de 20 combinaciones de teclas de acceso rápido y una interfaz dinámica y receptiva para garantizar la facilidad de uso y que su productividad se mantenga alta.
	Está escrito únicamente en JavaScript de la vieja escuela, pesa aproximadamente 65 KB y no tiene dependencia de backend o marco</p>

<img class="mid" src="/about/IIAP-Logo.png"" />
<p>También tiene muy buen soporte para navegadores y dispositivos.</p>


<h5>:: Lista de características ::</h5>

<ul>
<li>Cargando audio, navegando por la forma de onda, zoom y pan</li>
<li>Visualización de los niveles de frecuencia</li>
<li>Señalización de picos y distorsión</li>
<li>Cortar/Pegar/Recortar partes del audio</li>
<li>Inversión e inversión de audio</li>
<li>Exportar a Waw</li>
<li>Modificación de los niveles de volumen</li>
<li>Fundido de entrada/salida</li>
<li>Compresor</li>
<li>Normalización</li>
<li>Reverberación</li>
<li>Demorar</li>
<li>Distorsión</li>
<li>Cambio de tono</li>
<li>Realiza un seguimiento de los estados para que pueda deshacer los errores</li>
<li>¡Soporte fuera de línea!</li>
</ul>

<p>¡Y todo esto, en tan solo 83kb en la web de AUDIO-IIAP!</p>
</div>


<div>
<h3>Empezar</h3>


<p>Para empezar, arrastra y suelta un archivo de audio, o prueba la muestra incluida.<br />
	Una vez que el archivo esté cargado y pueda ver la forma del Espectrograma , acercar, desplazarse o seleccionar una región.</p>

<img class="mid" src="/about/IIAP-Logo.png" />


<h3>Grabación de audio</h3>

<p>Para grabar audio, simplemente presione el botón de grabación o el botón <i>[R]</i> key.</p>

<img class="mid" src="/about/OIP.jpeg" />


<h3>Exportar a mp3</h3>

<p>Para volver a exportar a mp3, haga clic en 'Archivo', luego en 'Exportar a mp3' y siga las instrucciones del modal.</p>

<img class="mid" src="/about/IIAP-Logo.png" />

</div>


<hr />


<div>
<h3>IIAP AUDIO V1.1 Y una breve perorata sobre el software.</h3>

<p>AUDIO IIAP  en agosto de 2023 . Hola!!).
	Comenzó como un proyecto desarrollado en el IIAP a solicitud de los biólogos para procesar audio y espectrogramas. Inicialmente, se creó como una herramienta básica para la visualización y manipulación de datos sonoros. Con el tiempo, se añadieron funcionalidades como cortar/copiar/pegar y la capacidad de fusionar entradas y salidas. Poco a poco, el enfoque en la precisión y la facilidad de uso transformaron el proyecto en un desafío para crear un editor completo para procesamiento de audio y espectrogramas. .</p>

<p>Hecho: Cristian Rodriguez <i>(BIOSONIC V1.1 </i>, derecho reservado IIAP-2023 

<p class="nomarg">Sonar</p>
<img class="mid" src="/about/IIAP-Logo.png"" />

<br />
<p class="nomarg">Bucles afrutados</p>
<img class="mid" src="/about/IIAP-Logo.png"" />

<br />

<p>Así que para IIAP AUDIO quería intentar hacer una interfaz rápida y eficaz.</p>

</div>

<hr />

<div>

<h3>Construyendo la interfaz</h3>

<p>Digamos que tenemos una <i>"PLAY"</i> y al pulsarlo comienza a reproducirse la pista. Supongo que queremos que el color y el estado del botón reflejen que la pista se está reproduciendo. Tan ingenuamente haríamos algo como;</p>


<pre><code>btn.onclick = function () {
	this.classList.add ('active');
};</code></pre>

<p>Pero ¿qué pasa si tenemos una tecla de acceso rápido que desencadena la misma acción? Digamos que presionamos <i>[SPACEBAR]</i> y la pista comienza a reproducirse. ¿Modificamos la clase de ese botón en el controlador de la barra espaciadora?</p>

<pre><code>document.onkeypress = function ( e ) { 
  if ( e.keyCode === 32) {
       e.preventDefault ();

       document.querySelector ('.playbtn').classList.add ('active');
  }
};</code></pre>

<p>¿Y qué sucede si hay 2 botones o si uno se elimina dinámicamente? ¿Seleccionamos todo e iteramos? Mmm...<br />
	Y si la pista está sonando y golpeamos <i>[SPACEBAR]</i> o el botón de reproducir nuevamente, debemos dejar de jugar. ¿Qué hacemos entonces? Puedes ver cómo esto se vuelve complicado muy rápidamente ya que todo se une muy estrechamente en una gran bola de dependencia..</p>



<p>Presentamos el patrón de observador. Las acciones están representadas por eventos. Entonces la lógica anterior y se expresa como;</p>


<pre><code>btn.onclick = function () {
	FireEvent ('RequestTogglePlay');
};

On ('WillPlay', function () {
	btn.classList.add ('active');
});

On ('WillStop', function () {
	btn.classList.remove ('active');
});



document.onkeypress = function ( e ) {
  if ( e.keyCode === 32) {
       e.preventDefault ();

       FireEvent ('RequestTogglePlay');
  }
};



On ('RequestTogglePlay', function () {
	if (track.is_playing) {
		FireEvent ('WillStop');
		track.stop ();
	}
	else {
		FireEvent ('WillPlay');
		track.play ();
	}
});

track.onPlayStart = function () {
	FireEvent ('DidPlay');
};
track.onPlayStop = function () {
	FireEvent ('DidStop');
};
</code></pre>

<p> ¡Ahora esto está completamente desacoplado y libre de dependencias! El botón establecerá su estado según los eventos que reciba, y tanto el botón como la tecla de la barra espaciadora dependen de los mismos mecanismos..
	Puedes notar el vocabulario que estamos usando. <i>"Request"</i>, <i>"Will"</i> and <i>"Did"</i>. Estos se eligen arbitrariamente para imponer alguna estructura adicional.<br /> <i>"Request"</i> denotes intent to perform an action, it is not guaranteed that the action will execute as there might be conditions preventing it (eg unitialized or still loading objects). <i>"Will"</i> means that the conditions passed and we are attempting to perform the action. And <i>"Did"</i> means that the action just got performed.<br />
	Puede que sea demasiado detallado, pero funcionó muy bien para estructurar la interfaz de AUDIO-IIAP..</p>
</div>

<hr />

<div>
<h3>Interfaz de usuario acoplable</h3>

<p>Una cosa que me encanta de las interfaces DAW es que todas las ventanas se pueden abrir desde el host principal. Recuerdo con cariño tener 3 pantallas llenas de complementos VST. Entonces, ¿podemos hacer lo mismo en el navegador?</p>


<video src="/about/dock_ui.mp4" autoplay muted playsinline controls loop></video>


<p>¡Sí! Y está utilizando algunos de los trucos más antiguos del libro. Básicamente creamos una ventana emergente con <i>window.open</i> and just pass buffers to its <i>documentWindow</i> object. Surprisingly it is quite performant on all browsers except IE Edge. I believe they are serializing in ascii or base64 every packet or something. Also Chrome has an interesting bug where you can't pass more than 512 byte buffers.</p>

<p>So for the undocked window, we call <i>window.open</i>. But how do we make it work when it is docked? It would be quite cumbersome to write the same functionality twice, once as a standalone page, and once as an in-page script. Luckily we can avoid that completely, and re-use the same page by using iframes.</p>

<p>The only difference is that the undocked version uses <i>window.opener</i> to refference its parent, whereas the iframe uses <i>window.parent</i>.</p>

</div>


<hr />

<div>
<h3>Future work and performance considerations</h3>

<p>The next big feature that is planned, is multitrack support. The ability to mix tracks and different sounds is currently lacking and its usefulness as it stands is limited.</p>

<hr />

<p>There is also a lot of room for improvement in almost all aspects.</p>

<p>First of all we can further reduce the filesize by around 20kb by removing the library we are using for rendering the waveform. We use only a fraction of its functionality so there is no reason to include it all.</p>

<p>We can also optimize a lot the rendering of the waveform. I heavily modified the library used to compute and draw only the visible range. However it is still clearing and re-drawing all of the canvas at each frame. We can take advantage of 2d Context's translate calls, and shift the canvas around instead of redrawing all of the pixels.</p>

<p>We can also move some operations to a background thread, such as the filters processing so that the UI does not freeze when applying a long chain of effects.</p>

<br />


<p>Sin embargo, el mayor problema que encontré es la propia API de Web Audio. Cada operación da como resultado la iteración de múltiples matrices largas por cuadro. Finalmente, el recolector de basura se enciende y se introducen crujidos. La única forma de evitar esto es utilizar un fftSize pequeño, pero el rango de frecuencia con el que tenemos que trabajar es muy estrecho. Quizás una implementación WASM pura superaría el intento de modificar señales de audio con JS. Supongo que solo hay una forma de averiguarlo :) </p>
<p>además, <i>decodificarAudioData</i> no proporciona ninguna devolución de llamada de progreso y no hay forma de cancelarla. Entonces, si intentas cargar un archivo de audio enorme, desperdiciarás recursos hasta que se procese. Actualmente no hay forma de evitar esto y puede resultar molesto si envía un archivo grande por error.</p>

</div>

<br /><br /><br />

</div>
</body>

</html>